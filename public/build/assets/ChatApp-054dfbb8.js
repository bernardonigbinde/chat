import g from"./Conversation-7dbd266a.js";import u from"./ContactsList-38c248e5.js";import{u as i,j as p,l as h,o as C,g as f,d as b,a as n,b as o,q as r}from"./app-b0653bdb.js";import"./ChatFeed-b4b3b31e.js";import"./ChatComposer-0b73e8b3.js";const x={class:"p-0 flex flex-col rounded-lg"},v={class:"grid grid-cols-12 bg-opacity-60 max-h-full rounded-b-lg"},A={__name:"ChatApp",props:{messages:Array,contacts:Array,selectedContact:Object,user:Object},setup(l){const a=l;let e=i({contacts:a.contacts,messages:a.messages,selectedContact:a.selectedContact});p(()=>{Echo.private(`messages.${a.user.uuid}`).listen("MessageSent",s=>{c(s.message)}),e.contacts=_.sortBy(a.contacts,s=>s.unreadMessagesCount).reverse()});let d=s=>{e.selectedContact=s,e.messages=[],r.get(route("show.chat",e.selectedContact)).then(t=>{e.messages=t.data}).catch(t=>{console.log(t)})},m=s=>{r.post(route("send.chat.message",e.selectedContact),{text:encodeURIComponent(s)}).then(t=>{e.messages.push(t.data),c(t.data)})},c=s=>{e.selectedContact&&s.from===e.selectedContact.uuid&&e.messages.push(s)};return h(()=>{}),(s,t)=>(C(),f("div",x,[b("div",v,[n(g,{class:"col-span-9",contact:o(e).selectedContact,messages:o(e).messages,onSend:o(m)},null,8,["contact","messages","onSend"]),n(u,{class:"col-span-3 border-l border-l-1 border-l-gray-300",contacts:o(e).contacts,onSelectedContact:o(d)},null,8,["contacts","onSelectedContact"])])]))}};export{A as default};
